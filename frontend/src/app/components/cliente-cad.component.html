<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card">
                <div class="card-header">
                    <h3>{{ id ? 'Edit Client' : 'Add New Client' }}</h3>
                </div>
                <div class="card-body">
                    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
                        <div class="row">
                            <div class="form-group col-md-6 mb-3">
                                <label for="code" class="form-label">Client Code *</label>
                                <input
                                    type="number"
                                    id="code"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('code')"
                                    [class.is-valid]="form.get('code')?.valid && form.get('code')?.touched"
                                    placeholder="Enter client code"
                                    formControlName="code"
                                    min="1" />
                                <div *ngIf="getFieldError('code')" class="invalid-feedback">
                                    {{ getFieldError('code') }}
                                </div>
                            </div>

                            <div class="form-group col-md-6 mb-3">
                                <label for="name" class="form-label">Name *</label>
                                <input
                                    type="text"
                                    id="name"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('name')"
                                    [class.is-valid]="form.get('name')?.valid && form.get('name')?.touched"
                                    placeholder="Enter client name"
                                    formControlName="name"
                                    maxlength="100" />
                                <div *ngIf="getFieldError('name')" class="invalid-feedback">
                                    {{ getFieldError('name') }}
                                </div>
                            </div>

                            <div class="form-group col-md-6 mb-3">
                                <label for="email" class="form-label">Email *</label>
                                <input
                                    type="email"
                                    id="email"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('email')"
                                    [class.is-valid]="form.get('email')?.valid && form.get('email')?.touched"
                                    placeholder="Enter email address"
                                    formControlName="email" />
                                <div *ngIf="getFieldError('email')" class="invalid-feedback">
                                    {{ getFieldError('email') }}
                                </div>
                            </div>

                            <div class="form-group col-md-6 mb-3">
                                <label for="pincode" class="form-label">Pincode *</label>
                                <input
                                    type="text"
                                    id="pincode"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('pincode')"
                                    [class.is-valid]="form.get('pincode')?.valid && form.get('pincode')?.touched"
                                    placeholder="Enter 6-digit pincode"
                                    formControlName="pincode"
                                    pattern="[0-9]{6}"
                                    maxlength="6" />
                                <div *ngIf="getFieldError('pincode')" class="invalid-feedback">
                                    {{ getFieldError('pincode') }}
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group col-md-6 mb-3">
                                <label for="phone" class="form-label">Phone</label>
                                <input
                                    type="tel"
                                    id="phone"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('phone')"
                                    [class.is-valid]="form.get('phone')?.valid && form.get('phone')?.touched"
                                    placeholder="Enter phone number"
                                    formControlName="phone" />
                                <div *ngIf="getFieldError('phone')" class="invalid-feedback">
                                    {{ getFieldError('phone') }}
                                </div>
                            </div>

                            <div class="form-group col-md-6 mb-3">
                                <label for="birthDate" class="form-label">Birth Date</label>
                                <input
                                    type="date"
                                    id="birthDate"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('birthDate')"
                                    [class.is-valid]="form.get('birthDate')?.valid && form.get('birthDate')?.touched"
                                    formControlName="birthDate" />
                                <div *ngIf="getFieldError('birthDate')" class="invalid-feedback">
                                    {{ getFieldError('birthDate') }}
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group col-md-12 mb-3">
                                <label for="address" class="form-label">Address</label>
                                <textarea
                                    id="address"
                                    class="form-control"
                                    [class.is-invalid]="getFieldError('address')"
                                    [class.is-valid]="form.get('address')?.valid && form.get('address')?.touched"
                                    placeholder="Enter address"
                                    formControlName="address"
                                    rows="3"
                                    maxlength="200"></textarea>
                                <div *ngIf="getFieldError('address')" class="invalid-feedback">
                                    {{ getFieldError('address') }}
                                </div>
                                <div class="form-text">{{ form.get('address')?.value?.length || 0 }}/200 characters</div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex gap-2">
                                    <button
                                        type="submit"
                                        class="btn btn-primary"
                                        [disabled]="loading">
                                        <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" aria-hidden="true"></span>
                                        {{ loading ? 'Saving...' : (id ? 'Update Client' : 'Create Client') }}
                                    </button>
                                    <button
                                        type="button"
                                        class="btn btn-secondary"
                                        (click)="onCancel()"
                                        [disabled]="loading">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div *ngIf="message" class="mt-3">
                        <div
                            class="alert"
                            [class.alert-success]="!isError"
                            [class.alert-danger]="isError"
                            role="alert">
                            {{ message }}
                        </div>
                    </div>

                    <div *ngIf="loading" class="text-center mt-3">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>